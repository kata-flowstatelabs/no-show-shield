<!doctype html>
<html lang="hu">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>No-Show Shield ‚Äì Id≈ëpont foglal√°s</title>
  <style>
    body{font:16px system-ui,Segoe UI,Roboto,Arial,sans-serif;max-width:900px;margin:40px auto;padding:0 16px}
    header a{margin-right:16px;text-decoration:none}
    label{display:block;margin:14px 0 6px}
    input,select,button{font:16px system-ui;padding:10px 12px}
    input,select{width:100%}
    .row{margin-top:16px}
    .muted{color:#666;font-size:14px;margin-top:10px}
  </style>
</head>
<body>
  <header>
    <a href="/" aria-label="home">üè†</a>
    <a href="/send-test" id="sendtest">send test</a>
    <a href="/schedule" id="menu-schedule">schedule</a>
    <a href="/schedule-ghl" id="menu-ghl">schedule GHL</a>
  </header>

  <h1>No-Show Shield ‚Äì Id≈ëpont foglal√°s</h1>

  <label for="email">√úgyf√©l e-mail</label>
  <input id="email" type="email" placeholder="pl. kata.flowstatelabs@gmail.com" required>

  <label for="mins">Kezd√©s ennyi perc m√∫lva</label>
  <select id="mins">
    <option value="3">3 perc (teszt)</option>
    <option value="5">5 perc</option>
    <option value="15">15 perc</option>
    <option value="60">60 perc</option>
  </select>

  <div class="row">
    <button id="save">Id≈ëpont r√∂gz√≠t√©se</button>
    <button id="clear" type="button">≈∞rlap t√∂rl√©se</button>
  </div>

  <div id="msg" class="muted"></div>

  <p class="muted">Renderen fut. Relat√≠v v√©gpontok: <code>/send-test</code>, <code>/schedule</code>, <code>/schedule-ghl</code>.</p>

  <script>
    const $ = s => document.querySelector(s);
    const msg = t => { $('#msg').textContent = t; };

    // send test link: GET /send-test
    $('#sendtest').addEventListener('click', async (e) => {
      e.preventDefault();
      msg('Teszt email k√ºld√©se‚Ä¶');
      try {
        const r = await fetch('/send-test');
        msg(r.ok ? 'Teszt email k√©r√©s elk√ºldve.' : 'Hiba a teszt k√©r√©sn√©l.');
      } catch { msg('H√°l√≥zati hiba a teszt k√©r√©sn√©l.'); }
    });

    // schedule button: POST /schedule  {email, minutes}
    $('#save').addEventListener('click', async () => {
      const email = $('#email').value.trim();
      const minutes = parseInt($('#mins').value, 10);
      if (!email) { msg('Adj meg egy e-mail c√≠met.'); return; }
      msg('Id≈ëpont r√∂gz√≠t√©se‚Ä¶');
      try {
        const r = await fetch('/schedule', {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify({ email, minutes })
        });
        const ok = r.ok;
        msg(ok ? '√útemezve. Eml√©keztet≈ëk hamarosan j√∂nnek.' : 'Hiba az √ºtemez√©sn√©l.');
      } catch { msg('H√°l√≥zati hiba az √ºtemez√©sn√©l.'); }
    });

    // optional link to GHL schedule endpoint
    $('#menu-schedule').addEventListener('click', e => { e.preventDefault(); fetch('/schedule'); });
    $('#menu-ghl').addEventListener('click', e => { e.preventDefault(); fetch('/schedule-ghl'); });

    $('#clear').onclick = () => { $('#email').value=''; $('#mins').value='3'; msg(''); };
  </script>
</body>
</html>
